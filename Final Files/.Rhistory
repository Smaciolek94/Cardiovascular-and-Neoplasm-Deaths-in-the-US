install.packages("xlsx")
"C:\Users\Stvma\Documents\GitHub\TSA-final-project\Final Files\Stefan Maciolek - Final Project Data.xlsx"
library(xlsx)
library(xlsx)
library(xlsx)
library(xlsx)
library(xlsx)
cmonth <- read.xlsx("C:\\Users\\Stvma\\Documents\\GitHub\\TSA-final-project\\Final Files\\Stefan Maciolek - Final Project Data.xlsx",sheet=2,header=T)
nmonth <- read.xlsx("C:\\Users\\Stvma\\Documents\\GitHub\\TSA-final-project\\Final Files\\Stefan Maciolek - Final Project Data.xlsx",sheet=4,header=T)
cyear <- read.xlsx("C:\\Users\\Stvma\\Documents\\GitHub\\TSA-final-project\\Final Files\\Stefan Maciolek - Final Project Data.xlsx",sheet=1,header=T)
nyear <-  read.xlsx("C:\\Users\\Stvma\\Documents\\GitHub\\TSA-final-project\\Final Files\\Stefan Maciolek - Final Project Data.xlsx",sheet=3,header=T)
library(readxl)
path <- "C:\\Users\\Stvma\\Documents\\GitHub\\TSA-final-project\\Final Files\\Stefan Maciolek - Final Project Data.xlsx"
cmonth <- read_xlsx(path,sheet=2)
nmonth <- read_xlsx(path,sheet=4)
cyear <- read_xlsx(path,sheet=1)
nyear <-  read_xlsx(path,sheet=3)
#DATA PRE-PROCESSING
#adding the population to the monthly files
cmonth$pop <- rep(0,240)
nmonth$pop <- rep(0,240)
for (i in 1:240){
index <- (i%/%12) + 1
cmonth$pop[i] <- cyear$Population[index]
nmonth$pop[i] <- nyear$Population[index]
}
cyear$prop <- cyear$Deaths / cyear$Population * 100
nyear$prop <- nyear$Deaths / nyear$Population * 100
#PRELIMINARY ANALYSIS
#plotting deaths by year
plot(cyear$Year,(cyear$Deaths/1000),type="o",main="Deaths Per Year",
xlab="Year",ylab="Deaths x 1000",ylim=c(0,1000),col="blue",xaxs="i",yaxs="i")
lines(nyear$Year,(nyear$Deaths/1000),,type="o",col="red")
grid(col="black",nx=19,ny=10)
legend("bottomleft",legend=c("Cardiovascular Issues","Neoplasm"),col=c("blue","red"),
pch=c(1,1))
#plotting proportion dead by year
plot(cyear$Year,cyear$prop,type="o",main="Percent Population Death per Year",
xlab="Year",ylab="% of Population Dying per Year",ylim=c(0,.35),col="blue",xaxs="i",yaxs="i")
lines(nyear$Year,nyear$prop,type="o",col="red")
grid(col="black",nx=19,ny=10)
legend("bottomleft",legend=c("Cardiovascular Issues","Neoplasm"),col=c("blue","red"),
pch=c(1,1))
cmonth$prop <- cmonth$Deaths / cmonth$pop * 100
nmonth$prop <- nmonth$Deaths / nmonth$pop * 100
cmonth$month <- seq(as.Date("1999/1/1"),as.Date("2018/12/1"),by="month")
nmonth$month <- seq(as.Date("1999/1/1"),as.Date("2018/12/1"),by="month")
#proportion dying per month
plot(cmonth$month,cmonth$prop,type="l",xlab="Date",ylab="% of Population Dying per Month",
main="Percent Population Death per Month",ylim=c(0,.036),col="blue",xaxs="i",yaxs="i")
lines(nmonth$month,nmonth$prop,type="l",col="red")
grid(col="black",nx=20,ny=10)
legend("bottomleft",legend=c("Cardiovascular Issues","Neoplasm"),col=c("blue","red"),
pch=c(1,1))
#CARDIOVASCULAR ANALYSIS
library(TSA)
cv<- ts(data<-cmonth$prop,start=c(1999,1),end=c(2018,12),frequency=12)
monthlab <- c("J","F","M","A","M","J","J","A","S","O","N","D")
plot(cv,type="l",xlab="Date",ylab="Percent",
main = "Percent Population Death",xaxs="i")
points(cv,pch=monthlab)
cdiff <- diff(cv)
plot(cdiff,type="l",xlab="Date",ylab="Percent",
main = "First Difference Percent Population Death",xaxs="i",)
points(cdiff,pch=monthlab)
scdiff <- diff(cdiff,12)
plot(scdiff,type="l",xlab="Date",ylab="Percent",
main = "First and Sesaonal Differences Percent Population Death",xaxs="i")
points(scdiff,pch=monthlab)
#acf
acf(na.omit(as.vector(scdiff)),main="Autocorrelation",lag.max=40)
#pacf
pacf(na.omit(as.vector(scdiff)),main="Partial Autocorreleation", lag.max=40)
#spectral
